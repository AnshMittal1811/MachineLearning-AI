## ViT hyperparameters

| Params | 102721 | 102821 | 102821-B | 102921 | 103021 |
| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| batch_size | 64 | 32 | 64 | 64 | 64 |
| patch_size | 16 | 16 | 16 | 16 | 16 |
| depth | 12 | 12 | 12 | 6 | 6 |
| dim | 256 | 256 | 512 | 256 | 256 |
| mlp_dim | 64 | 64 | 64 | 32 | 32 |
| num_heads | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| emb_dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 200 |
| gamma | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| class_weights | uniform | uniform | uniform | uniform | uniform |
| # params | 6,953,992 | 6,953,992 | 13,907,208 | 3,503,560 | 3,503,560 |
|  |  |  |  |  |  |
| train_acc | 84.14 | 78.27 | 79.94 | 81.22 | 79.96 |
| valid_acc | 81.44 | 79.55 | 80.73 | 81.23 | 70.76 |
| test_acc | 81.17 | 79.34 | 80.65 | 81.25 | 80.33 |

---


| Params | 102921 | 103121 | 110121 | 110121B | 110221 | 110321 |
| ----------- |  ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| batch_size |  64 | 64 | 64 | 64 | 64 | 64 |
| patch_size |  16 | 16 | 16 | 16 | 16 | 16 |
| depth | 6 | 6 | 6 | 8 | 8 | 8 |
| dim | 256 | 256 | 256 | 256 | 512 | 128 |
| mlp_dim | 32 | 32 | 32 | 32 | 32 | 32 |
| num_heads | 8 | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| emb_dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 1e-4 | 1e-3 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| class_weights | uniform | uniform | uniform | uniform | uniform | uniform |
| # params | 3,503,560 | 3,503,560 | 3,503,560 | 4,588,040 | 9,175,816 | 2,294,152 |
|  |  |  |  |  |  |  |
| train_acc | 81.22 | 80.19 | bad | 81.97 | 78.39 | 81.52 |
| valid_acc | 81.23 | 80.49 | bad | 81.36 | 79.59 | 81.25 |
| test_acc | 81.25 | 80.48 | bad | 81.46 | - | 81.3 |

---

| Params | 112321 | 112421 | 112421B | 112421C | 112521 | 112621 |
| ----------- | ----------- | ----------- |----------- |----------- |----------- |----------- |
| Notes | ArXiv params |  |  |  |  |  |
| batch_size | 64 | 64 | 64 |  64 | 64 | 64 |
| patch_size | 28 | 28 | 16 | 8 | 8 | 8 |
| depth | 12 | 12 | 8 |  8 | 8 | 8 |
| dim | 128 | 1024 | 1024 | 256 | 256 | 256 |
| mlp_dim | 64 | 64 | 64 | 64 | 32 | 16 |
| num_heads | 8 | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| emb_dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 |3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| class_weights | uniform | uniform | uniform | uniform | uniform |uniform |
| # params | 3,663,240 | 29,300,488 | 18,875,912 | 4,722,440 | 4,591,112 |  |
|  |  |  |  |  |  |  |
| train_acc | 78.63 | 50.07 | 48.13 | 81.27 | 81.99 |  |
| valid_acc | 79.60 | 52.17 | 49.88 | 81.18 | 81.42 |  |
| test_acc | 79.57 | - | 50.00 | 81.15 | 81.73 |  |


| Params | 110121B | 110421 | 110521 | 110521B | 110721 | 110821 | 121021 |
| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| batch_size | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
| patch_size |  16 | 16 | 16 | 16 | 16 | 16 | 16 |
| depth | 8 | 8 | 8 | 8 | 8 | 8 | 8 |
| dim | 256 | 256 | 256 | 512 | 128 | 256 | 128 |
| mlp_dim |  32 | 64 | 64 | 64 | 64 | 64 | 1024 |
| num_heads | 8 | 8 | 16 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| emb_dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 10 | 5 |
| gamma | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| class_weights | uniform | uniform | uniform | uniform | uniform | uniform | uniform |
| # params | 4,588,040 | 4,719,368 | 8,913,672 |  | 2,359,944 | 4,719,368 | 6,438,024 |
|  |  |  |  |  |  |  |  |
| train_acc | 81.97 | 82.61 | 79.57 | ~80 | 79.67 | 80.97 | 82.68 |
| valid_acc | 81.36 | 81.50 | 80.60 | - | 80.96 | 81.22 | 81.34 |
| test_acc |  81.46 | 81.66 | 80.40 | - | 80.77 | - | 81.59 |

| Params | 12??21 | 121221 |
| --- | --- | --- |
| batch_size | 64 | 16 |
| patch_size | 16 | 16 |
| depth | 12 | 12 |
| dim | 256 | 768 |
| mlp_dim | 1024 | 3072 |
| num_heads | 12 | 12 |
| dropout | 0.1 | 0.1 |
| emb_dropout | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 |
| step_size | 5 | 5 |
| gamma | 0.9 | 0.9 |
| class_weights | uniform | uniform |
| # params |  |  |
|  |  |  |
| train_acc |  | 44.04 |
| valid_acc |  | 46.19 |
| test_acc |   | 46.57 |



## Pre-Trained ViT-Base (HuggingFace)

no fine-tuned: 6,152 trainable parameters\
fine-tuned: 85,804,808 trainable parameters

| Params | 121121 | 121221 | 121221B | 121221C | 121321 | 121421 | 121421B |
| --- | --- | --- | --- | --- | --- | --- | --- |
| batch_size | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
| lr | 3e-4 | 1e-3  | 5e-5 | 5e-5 | 3e-4 | 5e-5 | 1e-4 |
| step_size | 5 | 5 | 5 | 10 | 5 | 1 | 10 |
| gamma | 0.9 | 0.9 | 0.9 | 0.1 | 0.9 | 0.1 | 0.1 |
| fine_tune | no | no | yes | yes | yes | yes | yes |
|  |  |  |  |  |  |  |  |
| train_acc | 69.63 | 70.33 | 86.18 (8 ep) | 91.73 | 84.81 | 83.61 | 90.70 |
| valid_acc | 67.97 | 68.28 | 83.25 (8 ep) | 84.25 | 83.30 | 83.37 | 84.19 |
| test_acc | 68.11 | 68.27 | 83.33 (8 ep)  | 84.41 | X | 83.60 | 84.53 |


| Params | 121521 | 122821 | 122921 | 010622 | 010722 | 010722B | 010722C | 010722D |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| batch_size | 64 | 64 | 64 | 32 | 64 | 64 | 64 | 64 |
| lr | 5e-5 | 1e-3 | 5e-5 | 5e-5 | 5e-5 | 5e-5 | 5e-5 | 5e-5 |
| step_size | 200 | 1 | 10 | 10 | 2 | 4 | 6 | 8 |
| gamma | 1.0 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| fine_tune | yes | yes | no | yes | yes | yes | yes | yes |
|  |  |  |  |  |  |  |  |  |
| train_acc | 69.63 | 67.15 | 66.31 | 91.93 | 85.71 | 87.07 | 87.89 | 90.60 |
| valid_acc | 67.97 | 67.49 | 64.60 | 84.07 | 84.11 | 84.89 | 84.71 | 84.49 |
| test_acc | 68.11 | 67.37 | 65.09 | 84.24 | 84.50 | 84.89 | 84.99 | 84.72 |


| Params | 010822 | 010822B | 010822C | 010822D | 010922 | 010922B | 011022 | 011322 | 011322B |
| --- | --- | --- |--- | --- | --- | --- | --- | --- | --- |
| batch_size | 64 | 64 | 16 | 32 | 64 | 64 | 64 | 64 | 64 |
| lr | 5e-5 | 5e-5 | 5e-5 | 5e-5 | 1e-4 | 1e-5 | 5e-5 | 8e-5 | 4e-5 |
| step_size | 3 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.2 | 0.1 | 0.1 |
| fine_tune | yes | yes | yes | yes | yes | yes | yes | yes | yes |
|  |  |  |  |  |  |  |  |  |  |
| train_acc | 86.70 | 87.45 | 87.37 | 87.64 | 87.38 | 85.24 | 87.60 | 87.52 | 87.26 |
| valid_acc | 84.75 | **84.91** | 84.79 | 84.72 | 84.76 | 84.10 | 84.81 | 84.87 | 84.87 |
| test_acc | 84.93 | 85.00 | 84.94 | 85.06 | 84.92 | 83.99 | 84.92 | 85.01 | 85.02 |


| Params | 011422 | 011422B | 011522 |
| --- | --- | --- | --- |
| batch_size | 64 | 64 | 64 |
| lr | 5e-5 | 5e-5 | 5e-5 |
| step_size | 1 | 5 | 5 |
| gamma | 0.9 | 0.9 | 0.5 |
| fine_tune | yes | yes | yes |
|  |  |  |  |
| train_acc | 87.96 | 86.86 | 87.98 |
| valid_acc | 84.03 | 83.72 | 84.22 |
| test_acc | 84.07 | 83.84 | 84.23 |


**Weighted loss**

Use [0.19, 0.21, 0.98, 0.38, 0.53, 0.66, 1.81, 3.23] --> 85.43% | 82.42% | 82.75%

Use [0.58, 0.50, 2.62, 1.20, 0.96, 0.63, 3.31, 9.17] --> 85.66% | 83.16% | 83.46%

## Linformer hyperparameters

| Params | arXiv | #102621# | 121021 | 121121 | 121221 | 121321 | 122921 | 122921B |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| shared_kv | False | True |
| batch_size | 64 | 64 | 64 | 32 | 64 | 64 | 64 | 64 |
| patch_size | 28 | 16 | 28 | 28 | 16 | 28 | 16 | 28 |
| depth | 12 | 12 | 12 | 12 | 12 | 12 | 12 | 12 |
| dim | 128 | 256 | 128 | 128 | 256 | 128 |128 | 256 |
| k_dim | 64 | 64 | 512 | 512 | 256 | 256 | 8 | 16 |
| num_heads | 8 | 8 | 8 | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma |  0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| # params | 2,785,416 | 9,082,888 |  | 2,888,328 | 9,536,776 | 2,688,648 | 2,495,208 | 8,969,416 |
|  |  |  |  |  |  |  |
| train_acc | 81.93^ | 82.63 | 80.96 | 81.07 | 82.34 | 82.19 | 83.74 | 84.14 |
| valid_acc | 80.35^ | 81.04 | 79.87 | 80.07 | 80.74 | 79.75 | 80.99 | 80.96 |
| test_acc | 80.55^ | 80.83 | 79.90 | 79.72 | 80.57 | 79.63 | 80.83 | 80.65 |

^ early-stopped due to disconnection

\#\# best Linformer performance

| Params | arXiv | 102621 | 123021 | 123021B | #123021C# | 123121 | 123121B | 010122 | 010122B |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| shared_kv | False | True | True | False | False | True | False | False | False |
| batch_size | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
| patch_size | 28 | 16 | 16 | 16 | 16 | 16 | 16 | 28 | 28 |
| depth | 12 | 12 | 12 | 12 | 12 | 12 | 12 | 12 | 12 |
| dim | 128 | 256 | 256 | 256 | 128 | 128 | 256 | 128 | 128 |
| k_dim | 64 | 64 | 8 | 64 | 16 | 16 | 8 | 8 | 64 |
| num_heads | 8 | 8 | 8 | 8 | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma |  0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| # params | 2,785,416 | 9,082,888 | 8,950,504 | 10,020,616 | 2,575,368 | 2,340,936 | 9,755,848 | 2,698,056 | 2,785,416 |
|  |  |  |  |  |  |  |  |  |  |
| train_acc | 81.93^ | 82.63 | 82.24 | 82.78 | 82.43 | 81.89 | 82.04 | 81.74 | 80.92 |
| valid_acc | 80.35^ | 81.04 | 80.70 | 80.93 | 81.04 | 80.36 | 80.83 | 81.01 | 80.32 |
| test_acc | 80.55^ | 80.83 | 80.36 | 80.88 | 81.03 | 80.17 | 80.75 | 80.99 | 80.05 |


| Params | 010222 | 010222B | 010322 | 010322B | 010322C | 010322D | 010422 | 010422B | 010522 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| shared_kv | False | True | False | False | False | False | False | False | False |
| batch_size | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 | 64 |
| patch_size | 16 | 16 | 16 | 16 | 16 | 16 | 16 | 16 | 16 |
| depth | 12 | 12 | 10 | 8 | 8 | 10 | 7 | 6 | 7 |
| dim | 128 | 128 | 128 | 128 | 128 | 128 | 128 | 128 | 64 |
| k_dim | 32 | 32 | 16 | 16 | 32 | 32 | 16 | 16 | 16 |
| num_heads | 8 | 8 | 8 | 8 | 8 | 8 | 8 | 8 | 8 |
| dropout | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 | 3e-4 |
| step_size | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 |
| gamma | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 | 0.9 |
| # params | 2,651,016 | 2,378,760 | 2,166,984 | 1,758,600 | 1,809,032 | 2,230,024 | 1,554,408 | 1,350,216 | 455,208 |
|  |  |  |  |  |  |  |  |  |
| train_acc | 82.62 | 84.41 | 82.60 | 82.57 | 81.81 | 82.25 | 81.96 | 81.49 | 80.52 |
| valid_acc | 80.59 | 80.88 | 81.25 | 81.01 | 80.65 | 80.75 | 81.26 | 80.88 | 80.82 |
| test_acc | 80.69 | 80.49 | 80.89 | 81.12 | 80.75 | 80.47 | 81.01 | 80.65 | ? |


| Params | 010522B | 010522C |
| --- | --- | --- |
| shared_kv | False | False |
| batch_size | 64 | 64 |
| patch_size | 16 | 16 |
| depth | 7 | 7 |
| dim | 128 | 128 |
| k_dim | 16 | 16 |
| num_heads | 4 | 2 |
| dropout | 0.1 | 0.1 |
| lr | 3e-4 | 3e-4 |
| step_size | 5 | 5 |
| gamma | 0.9 | 0.9 |
| # params | 1,554,408 | 1,554,408 |
|  |  |  |
| train_acc | 83.50 | 81.47 |
| valid_acc | **81.32** | 80.86 |
| test_acc | 81.21 | 80.82 |
